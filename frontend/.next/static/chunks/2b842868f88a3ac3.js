(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,54858,e=>{"use strict";let t={getItem:e=>window.localStorage.getItem(e),setItem(e,t){window.localStorage.setItem(e,t)},removeItem(e){window.localStorage.removeItem(e)}};function a(e){if(!e)return null;let t=e.trim();return t&&"undefined"!==t&&"null"!==t?t:null}async function r(e,s={}){let i=a(t.getItem("token")),o={"Content-Type":"application/json",...s.headers};i&&(o.Authorization=i);try{let t=await fetch(`http://localhost:8000${e}`,{...s,headers:o});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||`API error: ${t.status}`)}return t}catch(e){throw e}}e.s(["alertsAPI",0,{async getWatchlist(){let e=await r("/alerts/watchlist"),t=await e.json();if(Array.isArray(t))return t.map(e=>"string"==typeof e||"number"==typeof e?String(e):String(e?.neoId||e?.asteroidId||e?.id||"")).filter(e=>e.length>0);let a=t?.watchlist||t?.watched||t?.ids||t?.neoIds||[];return Array.isArray(a)?a.map(e=>"string"==typeof e||"number"==typeof e?String(e):String(e?.neoId||e?.asteroidId||e?.id||"")).filter(e=>e.length>0):[]},addToWatchlist:async(e,t=2e7,a=7)=>(await r("/alerts/watch",{method:"POST",body:JSON.stringify({neoId:e,alertDistanceKm:t,alertDaysBefore:a})})).json(),removeFromWatchlist:async e=>(await r(`/alerts/unwatch/${e}`,{method:"POST"})).json(),getNotifications:async()=>(await r("/alerts/notifications")).json(),markNotificationRead:async e=>(await r(`/alerts/notifications/${e}/read`,{method:"POST"})).json()},"chatAPI",0,{getChannels:async()=>(await r("/chat/channels")).json(),async getMessages(e={}){let t=new URLSearchParams;e.neoId&&t.set("neoId",e.neoId),e.limit&&t.set("limit",String(e.limit));let a=t.toString();return(await r(`/chat/messages${a?`?${a}`:""}`)).json()},sendMessage:async e=>(await r("/chat/messages",{method:"POST",body:JSON.stringify(e)})).json()},"dataHelpers",0,{getHazardLevel(e){if(!e.close_approach_data||0===e.close_approach_data.length)return"low";let t=e.close_approach_data[0].miss_distance?.kilometers?parseFloat(e.close_approach_data[0].miss_distance.kilometers):1/0,a=e.estimatedDiameter?.kilometers?.estimated_diameter_max||0;return e.is_potentially_hazardous_asteroid&&t<2e7?"high":t<5e7&&a>100?"medium":"low"},formatDistance(e){let t="string"==typeof e?parseFloat(e):e;return`${(t/1e6).toFixed(2)} M km`},formatVelocity(e){let t="string"==typeof e?3600*parseFloat(e):3600*e;return`${(t/3600).toFixed(2)} km/s`},formatDiameter:e=>`${e.toFixed(2)} km`,parseApproachDate:e=>new Date(e),getNextCloseApproach:e=>e&&0!==e.length?e[0]:null},"feedAPI",0,{async getAll(){let e=await r("/feed"),t=await e.json(),a=[];return Array.isArray(t)?a=t:t&&Array.isArray(t.near_earth_objects)&&(a=t.near_earth_objects),{near_earth_objects:a.map(e=>({id:e.id||e.neoId||String(e.id),name:e.name||e.full_name||e.designation||"Unknown",estimatedDiameter:{kilometers:{estimated_diameter_min:e.estimated_diameter_min||e.diameter_km||0,estimated_diameter_max:e.estimated_diameter_max||e.diameter_km||e.estimated_diameter||0}},close_approach_data:[{miss_distance:{kilometers:e.miss_distance_km||e.close_approach_km||e.miss_distance&&e.miss_distance.kilometers||"0"},relative_velocity:{kilometers_per_second:e.velocity_kms||e.relative_velocity&&e.relative_velocity.kilometers_per_second||"0"}}],is_potentially_hazardous_asteroid:!0===e.hazardous||!0===e.is_potentially_hazardous_asteroid||"true"===e.hazardous,__raw:e}))}},async getById(e){let t=await r(`/feed/${e}`),a=await t.json(),s=(Array.isArray(a)?a:a?.near_earth_objects||[]).find(t=>String(t.id)===String(e)||String(t.neoId)===String(e));return s?{id:s.id||s.neoId||String(s.id),name:s.name||s.full_name||"Unknown",estimatedDiameter:{kilometers:{estimated_diameter_min:s.estimated_diameter_min||s.diameter_km||0,estimated_diameter_max:s.estimated_diameter_max||s.diameter_km||s.estimated_diameter||0}},close_approach_data:[{miss_distance:{kilometers:s.miss_distance_km||"0"},relative_velocity:{kilometers_per_second:s.velocity_kms||"0"}}],is_potentially_hazardous_asteroid:!0===s.hazardous||!0===s.is_potentially_hazardous_asteroid,__raw:s}:null}},"storageHelpers",0,{setToken(e){let r=a(e);r?t.setItem("token",r):t.removeItem("token")},getToken:()=>a(t.getItem("token")),setUserId(e){t.setItem("userId",e)},getUserId:()=>t.getItem("userId"),clearAuth(){t.removeItem("token"),t.removeItem("userId")},isAuthenticated(){return!!this.getToken()}}])},86451,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(70065);function s({alerts:e=[],onDismiss:s,autoOpenOnNew:i=!1}){let[o,n]=(0,a.useState)(!1),d=(0,a.useRef)(0),l={low:"bg-secondary/20 text-secondary border-secondary/30",medium:"bg-accent/20 text-accent border-accent/30",high:"bg-destructive/20 text-destructive border-destructive/30"},m={low:"ðŸ“¢",medium:"âš ï¸",high:"ðŸš¨"},c={approach:"Close Approach",hazard:"Hazard Alert",update:"Data Update"},h=e.filter(e=>!e.read).length;return(0,a.useEffect)(()=>{i&&(h>d.current&&n(!0),d.current=h)},[h,i]),(0,t.jsx)("div",{className:"fixed bottom-6 right-6 z-50",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[o&&(0,t.jsxs)(r.Card,{className:"border-primary/20 bg-card/90 backdrop-blur w-80 shadow-2xl",children:[(0,t.jsx)(r.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(r.CardTitle,{className:"text-lg",children:"Alerts"}),(0,t.jsx)(r.CardDescription,{children:"Recent notifications"})]}),(0,t.jsx)("button",{onClick:()=>n(!1),className:"text-muted-foreground hover:text-foreground transition-colors",children:"âœ•"})]})}),(0,t.jsx)(r.CardContent,{className:"space-y-3 max-h-96 overflow-y-auto",children:0===e.length?(0,t.jsx)("p",{className:"text-muted-foreground text-center py-8 text-sm",children:"No alerts"}):e.map(e=>(0,t.jsxs)("div",{className:`p-3 rounded-lg border space-y-2 ${e.read?"border-border/50 bg-background/30":`border-l-4 ${l[e.severity]}`}`,children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2 flex-1",children:[(0,t.jsx)("span",{className:"text-lg mt-0.5",children:m[e.severity]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-foreground truncate",children:e.asteroidName}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:c[e.type]})]})]}),!e.read&&(0,t.jsx)("div",{className:"w-2 h-2 rounded-full bg-primary mt-1.5 shrink-0"})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground leading-relaxed",children:e.message}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-border/30",children:[(0,t.jsx)("span",{className:"text-[10px] text-muted-foreground",children:e.timestamp.toLocaleTimeString()}),s&&(0,t.jsx)("button",{onClick:()=>s(e.id),className:"text-[10px] text-primary hover:text-secondary transition-colors",children:"Dismiss"})]})]},e.id))})]}),(0,t.jsx)("button",{onClick:()=>n(!o),className:`flex items-center justify-center gap-2 w-14 h-14 rounded-full font-semibold transition-all shadow-lg ${h>0?"bg-gradient-to-br from-primary to-secondary text-foreground hover:from-primary/90 hover:to-secondary/90":"bg-primary/40 text-primary border border-primary/30 hover:bg-primary/30"}`,children:h>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-lg",children:"ðŸ””"}),(0,t.jsx)("span",{className:"text-xs font-bold w-5 h-5 rounded-full bg-destructive text-destructive-foreground flex items-center justify-center",children:h>9?"9+":h})]}):(0,t.jsx)("span",{className:"text-lg",children:"ðŸ””"})})]})})}var i=e.i(54858);function o(){let[e,r]=(0,a.useState)([]);(0,a.useEffect)(()=>{let e,t=!0,a=async()=>{if(i.storageHelpers.getToken())try{let e=await i.alertsAPI.getNotifications(),a=Array.isArray(e?.notifications)?e.notifications:[];if(!t)return;r(a)}catch(e){}};return a(),e=window.setInterval(a,3e4),()=>{t=!1,e&&window.clearInterval(e)}},[]);let o=(0,a.useMemo)(()=>e.filter(e=>!e.isRead).map(e=>{let t=function(e){let t=e.match(/risk level for asteroid\s+(.+?)\s+is\s+(low|medium|high)/i);if(t)return{asteroidName:t[1].trim(),type:"hazard",severity:t[2].toLowerCase()};let a=e.match(/Asteroid\s+(.+?)\s+(is within|will pass)/i);return a?{asteroidName:a[1].trim(),type:"approach",severity:"medium"}:{asteroidName:"Unknown Asteroid",type:"update",severity:"low"}}(e.message);return{id:e.id,asteroidName:t.asteroidName,type:t.type,severity:t.severity,message:e.message,timestamp:new Date(e.createdAt),read:e.isRead}}),[e]),n=async e=>{try{await i.alertsAPI.markNotificationRead(e),r(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t))}catch(e){}};return(0,t.jsx)(s,{alerts:o,onDismiss:n,autoOpenOnNew:!0})}e.s(["default",()=>o],86451)}]);